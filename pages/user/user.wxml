<!--pages/user/user.wxml-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¤´éƒ¨ -->
  <view class="user-header">
    <view class="avatar-container">
      <image class="user-avatar" src="{{userInfo.avatar || '/images/default_avatar.png'}}" mode="aspectFill"></image>
    </view>
    <view class="user-info">
      <view class="user-name">{{userInfo.name || 'å¼ ä¸‰'}}</view>
      <view class="user-id">å­¦å·ï¼š{{userInfo.studentId || '20230001'}}</view>
      <view class="user-level">æ°´å¹³ï¼š{{quickStats.currentStage === 'beginner' ? 'åˆå­¦è€…' : quickStats.currentStage === 'intermediate' ? 'ä¸­çº§' : 'é«˜çº§'}}</view>
    </view>
  </view>
  
  <!-- å¿«é€Ÿç»Ÿè®¡ï¼ˆéé‡å¤åŠŸèƒ½ï¼‰ -->
  <view class="quick-stats">
    <view class="stats-item">
      <view class="stats-value">{{quickStats.todayStreak}}</view>
      <view class="stats-label">ä»Šæ—¥æ‰“å¡</view>
    </view>
    <view class="stats-item">
      <view class="stats-value">{{quickStats.totalDays}}</view>
      <view class="stats-label">ç´¯è®¡å¤©æ•°</view>
    </view>
  </view>
  
  <!-- å¤ä¹ æé†’ -->
  <view class="review-section" wx:if="{{learningSettings.reviewReminder && reviewReminders.length > 0}}">
    <view class="section-header">
      <text class="section-title">ğŸ“… å¤ä¹ æé†’</text>
      <text class="review-count">{{reviewReminders.length}}ä¸ªè¯å¾…å¤ä¹ </text>
    </view>
    <view class="review-reminder">
      <view class="reminder-text">æœ‰è¯è¯­éœ€è¦å¤ä¹ å•¦ï¼</view>
      <button class="review-btn" bindtap="startReview" size="mini" type="primary">ç«‹å³å¤ä¹ </button>
    </view>
  </view>
  
  <!-- æˆå°±ç³»ç»Ÿ -->
  <view class="achievements-section">
    <view class="section-header">
      <text class="section-title">ğŸ† æˆ‘çš„æˆå°±</text>
      <text class="view-all-btn" bindtap="viewAllAchievements">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    <view class="achievements-grid">
      <view class="achievement-item {{item.unlocked ? 'unlocked' : 'locked'}}" wx:for="{{achievements}}" wx:key="id">
        <view class="achievement-icon">{{item.icon}}</view>
        <view class="achievement-info">
          <view class="achievement-title">{{item.title}}</view>
          <view class="achievement-desc">{{item.description}}</view>
        </view>
        <view class="achievement-status">
          <text class="status-text">{{item.unlocked ? 'å·²è·å¾—' : 'æœªè·å¾—'}}</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-card">
    <view class="menu-item" bindtap="openLearningSettings">
      <image class="menu-icon" src="/images/icon_edit.png" mode="aspectFit"></image>
      <text class="menu-text">å­¦ä¹ åå¥½è®¾ç½®</text>
      <view class="menu-detail">
        <text class="detail-text">ç›®æ ‡: {{learningSettings.dailyTarget}}è¯/æ—¥</text>
      </view>
      <view class="arrow-icon">ã€‰</view>
    </view>
    
    <view class="menu-item" bindtap="viewLearningHistory">
      <image class="menu-icon" src="/images/icon_stats.png" mode="aspectFit"></image>
      <text class="menu-text">å­¦ä¹ å†å²</text>
      <view class="menu-detail">
        <text class="detail-text">æŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡</text>
      </view>
      <view class="arrow-icon">ã€‰</view>
    </view>
    
    <view class="menu-item" bindtap="openDataManagement">
      <image class="menu-icon" src="/images/icon_service.png" mode="aspectFit"></image>
      <text class="menu-text">æ•°æ®ç®¡ç†</text>
      <view class="menu-detail">
        <text class="detail-text">å¯¼å‡º/æ¸…ç†/é‡ç½®</text>
      </view>
      <view class="arrow-icon">ã€‰</view>
    </view>
    
    <view class="menu-item" bindtap="aboutUs">
      <image class="menu-icon" src="/images/icon_about.png" mode="aspectFit"></image>
      <text class="menu-text">å…³äºæˆ‘ä»¬</text>
      <view class="arrow-icon">ã€‰</view>
    </view>
    
    <view class="menu-item" bindtap="contactService">
      <image class="menu-icon" src="/images/icon_service.png" mode="aspectFit"></image>
      <text class="menu-text">è”ç³»å®¢æœ</text>
      <view class="arrow-icon">ã€‰</view>
    </view>
  </view>
  
  <!-- å­¦ä¹ åå¥½å¿«é€Ÿå¼€å…³ -->
  <view class="settings-toggles">
    <view class="toggle-item">
      <text class="toggle-label">å¤ä¹ æé†’</text>
      <switch checked="{{learningSettings.reviewReminder}}" bindchange="toggleReviewReminder" color="#4A90E2"/>
    </view>
    <view class="toggle-item">
      <text class="toggle-label">å£°éŸ³å¼€å…³</text>
      <switch checked="{{learningSettings.soundEnabled}}" bindchange="toggleSound" color="#4A90E2"/>
    </view>

  </view>
  
  <!-- é€€å‡ºç™»å½•æŒ‰é’® -->
  <button class="logout-button" bindtap="logout">é€€å‡ºç™»å½•</button>
  
  <!-- é¡µè„š -->
  <view class="footer">
    è¯å¢ƒé€š v1.0.0 Â© 2025
  </view>

  <!-- å…¨éƒ¨æˆå°±å¼¹çª— - ç®€åŒ–ç‰ˆ -->
  <view class="achievements-modal-simple" wx:if="{{showAllAchievements}}" bindtap="closeAllAchievements">
    <view class="modal-simple-content" catchtap="">
      <!-- æ ‡é¢˜æ  -->
      <view class="simple-header">
        <text class="simple-title">ğŸ† å…¨éƒ¨æˆå°± ({{achievementStats.unlockedCount}}/{{achievementStats.totalCount}})</text>
        <view class="simple-close" bindtap="closeAllAchievements">Ã—</view>
      </view>
      
      <!-- æˆå°±åˆ—è¡¨ - ç›´æ¥æ¸²æŸ“ï¼Œä¸ç”¨scroll-view -->
      <view class="simple-achievements">
        <!-- å…¨éƒ¨æˆå°± - ä¸åˆ†ç±»ï¼Œç›´æ¥å…¨éƒ¨æ˜¾ç¤º -->
        <view class="simple-category">
                     <view class="simple-category-title">ğŸ† å…¨éƒ¨æˆå°± (å…±{{allAchievementsList.length}}ä¸ª)</view>
          <view class="simple-grid">
            <view 
              class="simple-achievement {{item.unlocked ? 'simple-unlocked' : 'simple-locked'}}" 
              wx:for="{{allAchievementsList}}" 
              wx:key="id"
            >
              <text class="simple-icon">{{item.icon}}</text>
              <view class="simple-info">
                <text class="simple-name">{{item.title}}</text>
                <text class="simple-desc">{{item.description}}</text>
              </view>
              <text class="simple-status">{{item.unlocked ? 'âœ“' : 'â—‹'}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- åº•éƒ¨æŒ‰é’® -->
      <view class="simple-footer">
        <button class="simple-btn" bindtap="closeAllAchievements">çŸ¥é“äº†</button>
      </view>
    </view>
  </view>
</view> 